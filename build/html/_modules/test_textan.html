<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>test_textan &mdash; Documentation S2App5informatique 1.1</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=de505bba"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=d99ca74e"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            S2App5informatique
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../textan_CIP1_CIP2.html">Module textan_CIP1_CIP2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug_handler_common.html">Module debug_handler_common</a></li>
<li class="toctree-l1"><a class="reference internal" href="../textan_common.html">Module textan_common</a></li>
<li class="toctree-l1"><a class="reference internal" href="../test_textan.html">Module test_textan</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">S2App5informatique</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Code du module</a></li>
      <li class="breadcrumb-item active">test_textan</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Code source de test_textan</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#</span>
<span class="c1">#  Programme python pour l&#39;évaluation du code de détection des auteurs et de génération de textes</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#  Copyright 2018-2023 F. Mailhot et Université de Sherbrooke</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">timeit</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">debug_handler_common</span>


<div class="viewcode-block" id="ParsingClassTextAn">
<a class="viewcode-back" href="../test_textan.html#test_textan.ParsingClassTextAn">[docs]</a>
<span class="k">class</span> <span class="nc">ParsingClassTextAn</span><span class="p">:</span>
<div class="viewcode-block" id="ParsingClassTextAn.parse_cli">
<a class="viewcode-back" href="../test_textan.html#test_textan.ParsingClassTextAn.parse_cli">[docs]</a>
    <span class="k">def</span> <span class="nf">parse_cli</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Utilise le module argparse pour :</span>
<span class="sd">            - Enregistrer les commandes à reconnaître</span>
<span class="sd">            - Lire la ligne de commande et créer le champ self.args qui récupère la structure produite</span>

<span class="sd">        Returns :</span>
<span class="sd">            void : Au retour, toutes les commandes reconnues sont comprises dans self.args</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="s2">&quot;textan_CIP1_CIP2.py&quot;</span><span class="p">)</span>

        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-d&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;TextesPourEtudiants&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Répertoire contenant les sous-repertoires des auteurs </span><span class="se">\</span>
<span class="s2">                            (TextesPourEtudiants par défaut)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Résultats à produire pour cet auteur spécifique&quot;</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Fichier inconnu pour lequel on recherche un auteur&quot;</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-m&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Mode (1 ou 2 ou 3 ou ... 20) - unigrammes ou digrammes ou trigrammes ou ...&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-F&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Indication du rang (en fréquence) du mot (ou n-gramme) a imprimer&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-G&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Génération de texte avec les statistiques de tous les auteurs&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-Ga&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Génération de texte avec les statistiques de cet auteur&quot;</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-g_size&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Taille du texte à générer&quot;</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-g_base&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;Gen_text&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Nom de base du fichier de texte à générer&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-g_ext&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Extension utilisée pour le fichier généré, .txt par défaut&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-g_nocip&quot;</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Ne pas utiliser les CIPs dans le nom du fichier généré&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-g_noaut&quot;</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Ne pas utiliser le nom de l&#39;auteur dans le nom du fichier généré&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-g_sep&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Utiliser cette chaine de caractères comme séparateur dans le nom de fichier généré&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-g_reformat&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Indique que le reformattage doit être utilisé dans le texte généré&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Mode verbose&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-noPonc&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Retirer la ponctuation&quot;</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-rep_code&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Répertoire contenant la liste des CIPs et le code textan_CIP1_CIP2.py&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-recursion&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Récursion maximale permise (par défaut, 1000)&quot;</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-r1&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Retrait des mots de 1 caractère&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-r2&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Retrait des mots de 2 caractères&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-golden&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Compare les résultats avec la version &#39;golden&#39; indiquée par ce paramètre&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-fichier_res&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Tous les prints seront faits dans ce fichier&quot;</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-dir_res&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Tous les résultats seront ajoutés dans ce répertoire (sous le répertoire courant)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-timeout&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Temps maximum (secondes) pour l&#39;exécution du système&quot;</span>
        <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;-compare_auteurs&quot;</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Indique les proximités des textes des différents auteurs&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">parser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="ParsingClassTextAn.setup_after_parse">
<a class="viewcode-back" href="../test_textan.html#test_textan.ParsingClassTextAn.setup_after_parse">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_after_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Utilise le champ args pour :</span>
<span class="sd">            - Définir tous les champs modifiables par la ligne de commande</span>
<span class="sd">            - Ouvrir un fichier de résultats (si demandé) et y rediriger stdout</span>

<span class="sd">        Returns :</span>
<span class="sd">            void : Au retour, toutes les commandes reconnues sont comprises dans self.args</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">d</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">d</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">noPonc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">keep_punc</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">m</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ngram</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">m</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">G</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">Ga</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">g_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gen_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">g_size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gen_basename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">g_base</span>
            <span class="c1"># if self.gen_size &gt; 0:</span>
            <span class="c1">#     self.gen_text = True</span>
            <span class="c1">#     if self.args.g:</span>
            <span class="c1">#         self.gen_basename = self.args.g</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">g_ext</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">g_ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">g_ext</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">g_nocip</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">g_cip</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">g_noaut</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">g_aut</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">g_sep</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">g_sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">g_sep</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">Ga</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">g_auteur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">Ga</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gen_text</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">G</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gen_text_all</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">a</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auteur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">a</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">rep_code</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rep_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">rep_code</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">f</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_author</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">F</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">do_get_nth_ngram</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nth_ngram</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">F</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">r1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_word_1</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">r2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_word_2</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">fichier_res</span><span class="p">:</span>
            <span class="c1"># https://stackoverflow.com/questions/5104957/how-do-i-create-a-file-at-a-specific-path</span>
            <span class="n">cur_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">dir_res</span><span class="p">:</span>
                <span class="n">dir_res_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">dir_res</span><span class="p">,</span> <span class="n">cur_path</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>  <span class="c1"># https://stackoverflow.com/questions/273192/how-can-i-safely-create-a-nested-directory</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dir_res_path</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dir_res_path</span> <span class="o">=</span> <span class="n">cur_path</span>
            <span class="n">output_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_res_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">fichier_res</span><span class="p">)</span>
            <span class="c1"># Voir: https://stackoverflow.com/questions/4675728/redirect-stdout-to-a-file-in-python</span>
            <span class="c1"># et: https://stackoverflow.com/questions/3597480/how-to-make-python-3-print-utf8</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">recursion</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">setrecursionlimit</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">recursion</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># https://docs.python.org/3/library/os.path.html#os.path.realpath</span>
                <span class="c1"># https://www.tutorialspoint.com/python/os_readlink.htm</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;L&#39;oeuvre &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span><span class="p">,</span> <span class="s2">&quot; n&#39;est pas accessible&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug_handler</span><span class="o">.</span><span class="n">print_debug_info</span><span class="p">()</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">compare_auteurs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">do_check_auteur_distance</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="ParsingClassTextAn.setup_and_parse_cli">
<a class="viewcode-back" href="../test_textan.html#test_textan.ParsingClassTextAn.setup_and_parse_cli">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_and_parse_cli</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise l&#39;objet en interprétant la ligne de commande :</span>
<span class="sd">            - Lit la ligne de commande</span>
<span class="sd">            - Modifie tous les champs qui y sont définis</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Au retour, toutes les commandes reconnues sont comprises dans self.args</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_cli</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_after_parse</span><span class="p">()</span>
        <span class="k">return</span></div>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructeur pour la classe TestTextAn.  Initialisation de l&#39;ensemble des éléments requis</span>

<span class="sd">        Args :</span>
<span class="sd">            (void) : Le constructeur lit la ligne de commande et ajuste l&#39;état de l&#39;objet TestTextAn en conséquence</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Au retour, la nouvelle instance de test est prête à être utilisée</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dir</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ngram</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep_punc</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen_text</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen_text_all</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen_size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen_basename</span> <span class="o">=</span> <span class="s2">&quot;Gen_text&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cip</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textan_module</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">golden_module</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g_ext</span> <span class="o">=</span> <span class="s2">&quot;.txt&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g_cip</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g_aut</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g_sep</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rep_code</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auteur</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_author</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tests</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_analyze</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_get_nth_ngram</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_word_1</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_word_2</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nth_ngram</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auteurs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textan</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_check_auteur_distance</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_handler</span> <span class="o">=</span> <span class="n">debug_handler_common</span><span class="o">.</span><span class="n">DebugHandler</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setup_and_parse_cli</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_and_setup_golden</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_handler</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cips</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_cips</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_cwd_to_sys_path</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_modules</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_something_to_do</span><span class="p">()</span>
        <span class="k">return</span></div>



<div class="viewcode-block" id="TestTextAn">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn">[docs]</a>
<span class="k">class</span> <span class="nc">TestTextAn</span><span class="p">(</span><span class="n">ParsingClassTextAn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classe à utiliser pour valider la résolution de la problématique :</span>

<span class="sd">        - Contient tout le nécessaire pour tester la problématique.</span>

<span class="sd">    Pour valider la solution de la problématique, effectuer :</span>
<span class="sd">        - python test_textan.py -help</span>
<span class="sd">            + Indique tous les arguments et options disponibles</span>

<span class="sd">    Copyright 2018-2023, F. Mailhot et Université de Sherbrooke</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TestTextAn.add_cwd_to_sys_path">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.add_cwd_to_sys_path">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_cwd_to_sys_path</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ajoute le répertoire d&#39;exécution local aux chemins utilisés par le système.</span>
<span class="sd">           Sinon, si test_textan.py est un lien symbolique, les fichiers textan_CIP1_CIP2.py ne sont pas trouvés</span>

<span class="sd">        Args :</span>
<span class="sd">            (void) : Utilisation des informations système</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Au retour, le répertoire d&#39;exécution est ajouté au chemin système</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.sort_author_distance">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.sort_author_distance">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">sort_author_distance</span><span class="p">(</span><span class="n">author_res</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retourne le deuxième élément du vecteur (auteur, proximité) (utilisé pour le tri de la liste des auteurs)</span>

<span class="sd">        Args :</span>
<span class="sd">            ([str, float]) : Liste des auteurs et valeur de proximité avec le texte inconnu (résultat du produit scalaire)</span>
<span class="sd">            pour chacun des auteurs</span>

<span class="sd">        Returns :</span>
<span class="sd">            (float) : Valeur de la proximité de l&#39;auteur avec le texte inconnu</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">author_res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>


    <span class="c1"># Si mode verbose, refléter les valeurs des paramètres passés sur la ligne de commande</span>
<div class="viewcode-block" id="TestTextAn.print_params">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.print_params">[docs]</a>
    <span class="k">def</span> <span class="nf">print_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mode verbose, imprime l&#39;ensemble des paramètres utilisés pour ce test :</span>
<span class="sd">            - Valeur des paramètres par défaut s&#39;ils n&#39;ont pas été modifiés sur la ligne de commande</span>
<span class="sd">            - Ensemble des tests demandés</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Ne fait qu&#39;imprimer les valeurs contenues dans self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">v</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mode verbose: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cip</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">f</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Fichier inconnu à étudier: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Chemin complet de l&#39;oeuvre inconnue: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Calcul avec des &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-grammes&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">F</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">F</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Le premier ngramme le plus fréquent sera trouvé&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Le &quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">F</span><span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot;e ngramme le plus fréquent sera trouvé&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">a</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Auteur étudié: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">noPonc</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Retrait des signes de ponctuation&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Conservation des signes de ponctuation&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_word_1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Retrait des mots de 1 lettre&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Conservation des mots de 1 lettre&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_word_2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Retrait des mots de 2 lettres&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Conservation des mots de 2 lettres&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">G</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Génération d&#39;un texte de &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">G</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; mots, pour l&#39;auteur: &quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">auteur</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Le nom du fichier généré sera: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gen_file_name</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">recursion</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Récursion maximale: &quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">getrecursionlimit</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Temps d&#39;exécution maximal: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span> <span class="s2">&quot; secondes&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Calcul avec les auteurs du répertoire: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Liste des auteurs: &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auteurs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">auteurs</span><span class="p">:</span>
            <span class="n">aut</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    &quot;</span> <span class="o">+</span> <span class="n">aut</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">compare_auteurs</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">La proximité des textes de l&#39;ensemble des auteurs sera calculée&quot;</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.setup_instance_param">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.setup_instance_param">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_instance_param</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Définit les paramètres de l&#39;instance (étudiante) à tester</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Rien n&#39;est retourné</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ajout de l&#39;information nécessaire dans l&#39;instance à tester de la classe TextAn sous étude :</span>
        <span class="c1">#   Utilisation de la ponctuation (ou non), taille des n-grammes, répertoire des auteurs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">noPonc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">set_ponc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">set_ponc</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">set_ngram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngram</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">set_aut_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">set_remove_word_1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_word_1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">set_remove_word_2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_word_2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">auteurs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">auteurs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_params</span><span class="p">()</span>  <span class="c1"># Imprime l&#39;état de l&#39;instance (si le mode verbose a été utilisé sur la ligne de commande)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.get_gen_file_name">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.get_gen_file_name">[docs]</a>
    <span class="k">def</span> <span class="nf">get_gen_file_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Définit le nom du fichier à générer</span>

<span class="sd">        Returns :</span>
<span class="sd">            str : Nom du fichier à générer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_basename</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_cip</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_sep</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cip</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_aut</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_sep</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">auteur</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_ext</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_ext</span>
        <span class="k">return</span> <span class="n">name</span></div>


<div class="viewcode-block" id="TestTextAn.get_cips">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.get_cips">[docs]</a>
    <span class="k">def</span> <span class="nf">get_cips</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lit le fichier etudiants.txt, trouve les CIPs, et retourne la liste</span>
<span class="sd">           Le CIP est obtenu du fichier etudiants.txt, dans le répertoire courant</span>
<span class="sd">            ou tel qu&#39;indiqué en paramètre (option -rep_code)</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Au retour, tous les cips sont inclus dans la liste self.cips</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cip_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rep_code</span> <span class="o">+</span> <span class="s2">&quot;/etudiants.txt&quot;</span>
        <span class="n">cip_list</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">cip_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">cip_list</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;#&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="s2">&quot;%&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">student_cip</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cips</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">student_cip</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.import_textan_cip">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.import_textan_cip">[docs]</a>
    <span class="k">def</span> <span class="nf">import_textan_cip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">import_cip</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Importe le fichier textan_CIP1_CIP2.py, où &quot;CIP1_CIP2&quot; est passé dans le paramètre import_cip</span>

<span class="sd">        Args :</span>
<span class="sd">            import_cip (str) : Contient &quot;CIP1_CIP2&quot;, les cips pour le code à tester</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Au retour, le module textan_CIP1_CIP2 est importé et remplace le précédent</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;init_module&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_modules</span><span class="p">:</span>
            <span class="c1"># Deuxième appel (ou subséquents) : enlever tous les modules supplémentaires</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_modules</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Premier appel : identifier tous les modules déjà présents</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_modules</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cip</span> <span class="o">=</span> <span class="n">import_cip</span>
        <span class="n">textan_name</span> <span class="o">=</span> <span class="s2">&quot;textan_&quot;</span> <span class="o">+</span> <span class="n">import_cip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textan_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">textan_name</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.check_and_setup_golden">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.check_and_setup_golden">[docs]</a>
    <span class="k">def</span> <span class="nf">check_and_setup_golden</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Vérifie si une version &quot;golden&quot; doit être conservée</span>

<span class="sd">        Args :</span>
<span class="sd">            (void) : Le nom de la version &quot;golden&quot; est disponible dans le champ self.args</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Au retour, le champ golden_module est initialisé (si nécessaire)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">golden</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">golden_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">golden</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">golden_module</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.check_something_to_do">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.check_something_to_do">[docs]</a>
    <span class="k">def</span> <span class="nf">check_something_to_do</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Vérifie que les paramètres d&#39;entrée indiquent quelque chose à faire</span>

<span class="sd">        Args :</span>
<span class="sd">            (void) : Toute l&#39;information nécessaire est présente dans l&#39;objet</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Au retour, le champ something_to_do indique le statut.  S&#39;il n&#39;y a rien à faire, sortie</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">something_to_do</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gen_text_all</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_text</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_author</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_get_nth_ngram</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">something_to_do</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Aucune action à effectuer. Utiliser un paramètre pour:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> - Générer un texte aléatoire&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> - Trouver l&#39;auteur d&#39;un texte inconnu&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> - Trouver le k-ième n-gramme le plus fréquent d&#39;un auteur&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
            <span class="n">exit</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.load_cip_code">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.load_cip_code">[docs]</a>
    <span class="k">def</span> <span class="nf">load_cip_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">student_cip</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Charge le code étudiant en mémoire, initialise l&#39;instance, initialise le débogage</span>

<span class="sd">        Args :</span>
<span class="sd">            student_cip (str) : Cips de l&#39;ensemble des membres de l&#39;équipe d&#39;APP</span>
<span class="sd">        Returns :</span>
<span class="sd">            (void) : Rien n&#39;est retourné : au retour, le code étudiant a été chargé en mémoire</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">import_textan_cip</span><span class="p">(</span>
            <span class="n">student_cip</span>
        <span class="p">)</span>  <span class="c1"># Chargement du code des étudiants identifiés par cip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textan_module</span><span class="o">.</span><span class="n">TextAn</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_instance_param</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_handler</span><span class="o">.</span><span class="n">start_execution_timing</span><span class="p">()</span>  <span class="c1"># Permet de mesurer le temps d&#39;exécution du code étudiant</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_handler</span><span class="o">.</span><span class="n">set_student_cip</span><span class="p">(</span>
            <span class="n">student_cip</span>
        <span class="p">)</span>  <span class="c1"># Indique le cip courant au gestionnaire de débogage</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.analyze">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.analyze">[docs]</a>
    <span class="k">def</span> <span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Effectue l&#39;analyse des textes fournis (calcul des fréquences pour chacun des auteurs) avec le code étudiant</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Rien n&#39;est retourné : au retour, les textes des auteurs ont été analysés</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.generate">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.generate">[docs]</a>
    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Effectue la génération d&#39;un texte aléatoire suivant les statistiques d&#39;un certain auteur (code étudiant)</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Rien n&#39;est retourné : au retour, un texte aléatoire a été généré, basé sur les statistiques</span>
<span class="sd">                        d&#39;un seul auteur, ou de l&#39;ensemble des auteurs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_text</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gen_file_name</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">gen_text_auteur</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auteur</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_size</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_text_all</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gen_file_name</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">gen_text_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen_size</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.find">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.find">[docs]</a>
    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calcule la proximité d&#39;un certain texte inconnu avec le &quot;style&quot; de chacun des auteurs avec le code étudiant</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Rien n&#39;est retourné : au retour, le texte inconnu a été comparé aux textes des auteurs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_author</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">find_author</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_result</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_author_distance</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">cip: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cip</span><span class="si">}</span><span class="s1"> - Fréquences pour l</span><span class="se">\&#39;</span><span class="s1">oeuvre &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">oeuvre</span><span class="si">}</span><span class="s1">&quot;: &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">--&gt; &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="c1"># https://stackoverflow.com/questions/493386/how-to-print-without-a-newline-or-space</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis_result</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.get_nth_ngram">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.get_nth_ngram">[docs]</a>
    <span class="k">def</span> <span class="nf">get_nth_ngram</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Obtient le n-ième plus fréquent n-gramme d&#39;un certain auteur avec le code étudiant</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Rien n&#39;est retourné : au retour, le n-ième n-gramme le plus fréquent a été imprimé</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_get_nth_ngram</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auteur</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Pas d&#39;auteur indiqué: impossible de donner le n-ième n-gramme.  Utiliser -a nom_de_l_auteur&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span>
            <span class="n">nth_ngram</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">get_nth_element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auteur</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nth_ngram</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">cip: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cip</span><span class="si">}</span><span class="s2"> - Auteur: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">auteur</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nth_ngram</span><span class="si">}</span><span class="s1">e n-gramme de </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ngram</span><span class="si">}</span><span class="s1"> mot</span><span class="si">{</span><span class="s2">&quot;s&quot;</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">ngram</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">nth_ngram</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="TestTextAn.check_auteur_distance">
<a class="viewcode-back" href="../test_textan.html#test_textan.TestTextAn.check_auteur_distance">[docs]</a>
    <span class="k">def</span> <span class="nf">check_auteur_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calcule et imprime la proximité entre chacun des auteurs (nombre entre 0 et 1)</span>

<span class="sd">        Returns :</span>
<span class="sd">            void : Rien n&#39;est retourné : au retour, la distance entre les différents auteurs a été imprimée</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_check_auteur_distance</span>
        <span class="p">):</span>  <span class="c1"># Par défaut de calcul n&#39;est pas fait.  Utiliser -compare_auteurs</span>
            <span class="k">return</span>

        <span class="n">res_table</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">auteur_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">res_table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">auteur_list</span>
        <span class="p">)</span>  <span class="c1"># La première ligne du tableau de résultats contiendra la liste des auteurs</span>
        <span class="n">auteur_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">res_buffer</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">{}</span>
        <span class="p">)</span>  <span class="c1"># Tampon pour conserver les valeurs de proximité d&#39;auteurs déjà calculées</span>
        <span class="k">for</span> <span class="n">auteur1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">auteurs</span><span class="p">:</span>
            <span class="n">auteur_res</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">res_table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">auteur_res</span><span class="p">)</span>
            <span class="n">auteur_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">auteur1</span><span class="p">)</span>
            <span class="n">auteur_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">auteur1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">auteur2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">auteurs</span><span class="p">:</span>
                <span class="n">auteurs_key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                    <span class="nb">sorted</span><span class="p">((</span><span class="n">auteur1</span><span class="p">,</span> <span class="n">auteur2</span><span class="p">))</span>
                <span class="p">)</span>  <span class="c1"># Conserver la valeur pour éviter de refaire le calcul</span>
                <span class="k">if</span> <span class="n">auteurs_key</span> <span class="ow">in</span> <span class="n">res_buffer</span><span class="p">:</span>
                    <span class="n">distance</span> <span class="o">=</span> <span class="n">res_buffer</span><span class="p">[</span><span class="n">auteurs_key</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">dot_product_aut</span><span class="p">(</span><span class="n">auteur1</span><span class="p">,</span> <span class="n">auteur2</span><span class="p">)</span>
                    <span class="n">res_buffer</span><span class="p">[</span><span class="n">auteurs_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span>
                <span class="n">auteur_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Comparaison des auteurs:&quot;</span><span class="p">)</span>
        <span class="c1"># https://learnpython.com/blog/print-table-in-python/</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">res_table</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;firstrow&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;fancy_grid&quot;</span><span class="p">))</span>
        <span class="k">return</span></div>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructeur pour la classe TestTextAn.  Initialisation de l&#39;ensemble des éléments requis</span>

<span class="sd">        Args :</span>
<span class="sd">            (void) : Le constructeur lit la ligne de commande et ajuste l&#39;état de l&#39;objet TestTextAn en conséquence</span>

<span class="sd">        Returns :</span>
<span class="sd">            (void) : Au retour, la nouvelle instance de test est prête à être utilisée</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">return</span></div>



<div class="viewcode-block" id="main">
<a class="viewcode-back" href="../test_textan.html#test_textan.main">[docs]</a>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Démarrage de l&#39;exécution du code de la problématique, pour l&#39;ensemble des équipes :</span>
<span class="sd">        - Initialise une instance de test</span>
<span class="sd">        - Pour chaque équipe (séquence de cips) :</span>
<span class="sd">            - Lire le code fourni par l&#39;équipe</span>
<span class="sd">            - Invoquer la méthode d&#39;analyse de texte de l&#39;équipe</span>
<span class="sd">            - Invoquer la méthode de génération de texte aléatoire</span>
<span class="sd">            - Calculer la proximité d&#39;un texte aléatoire avec les textes des auteurs fournis</span>
<span class="sd">            - Trouver le n-ième ngramme le plus fréquent pour un certain auteur</span>
<span class="sd">            - Trouver la distance entre les oeuvres des différents auteurs</span>
<span class="sd">        - Si le code est trop long à s&#39;exécuter (par défaut, 2 minutes), interrompre l&#39;exécution</span>
<span class="sd">        - Attrape toutes les exceptions non-traitées dans le code étudiant</span>

<span class="sd">    Args :</span>
<span class="sd">        (void) : Tout ce qui est nécessaire est défini à l&#39;intérieur de la méthode</span>

<span class="sd">    Returns :</span>
<span class="sd">        (void) : Au retour, l&#39;exécution est terminée</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">golden_tta</span> <span class="o">=</span> <span class="n">TestTextAn</span><span class="p">()</span>  <span class="c1"># Initialisation de l&#39;instance de test</span>

    <span class="k">for</span> <span class="p">(</span>
        <span class="n">cip</span>
    <span class="p">)</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="n">golden_tta</span><span class="o">.</span><span class="n">cips</span>
    <span class="p">):</span>  <span class="c1"># Permet de tester le code d&#39;une ou plusieurs équipes, à tour de rôle</span>
        <span class="n">tta</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
            <span class="n">golden_tta</span>
        <span class="p">)</span>  <span class="c1"># Copie fraiche de l&#39;objet, pour isoler les instances des étudiants</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">tta</span><span class="o">.</span><span class="n">load_cip_code</span><span class="p">(</span><span class="n">cip</span><span class="p">)</span>  <span class="c1"># Chargement et configuration du code étudiant</span>
            <span class="n">tta</span><span class="o">.</span><span class="n">textan</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>  <span class="c1"># Analyse des textes des auteurs (code étudiant)</span>
            <span class="n">tta</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>  <span class="c1"># Produit un texte aléatoire avec les mêmes statistiques que l&#39;auteur choisi (code étudiant)</span>
            <span class="n">tta</span><span class="o">.</span><span class="n">find</span><span class="p">()</span>  <span class="c1"># Calcul de proximité entre un texte inconnu et l&#39;ensemble des auteurs (code étudiant)</span>
            <span class="n">tta</span><span class="o">.</span><span class="n">get_nth_ngram</span><span class="p">()</span>  <span class="c1"># Trouve le n-ième n-gramme le plus fréquent d&#39;un certain auteur (code étudiant)</span>
            <span class="n">tta</span><span class="o">.</span><span class="n">check_auteur_distance</span><span class="p">()</span>

        <span class="c1"># Si le code étudiant est trop lent (120 secondes par défaut), interrompre</span>
        <span class="k">except</span> <span class="n">debug_handler</span><span class="o">.</span><span class="n">DebugHandlerTimeOutException</span><span class="p">:</span>
            <span class="n">tta</span><span class="o">.</span><span class="n">debug_handler</span><span class="o">.</span><span class="n">print_timeout_exception</span><span class="p">()</span>

        <span class="c1"># Mauvaise pratique (attraper toutes les exceptions), mais nécessaire ici, pour du code étudiant inconnu</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">tta</span><span class="o">.</span><span class="n">debug_handler</span><span class="o">.</span><span class="n">print_general_exception</span><span class="p">()</span>

        <span class="n">tta</span><span class="o">.</span><span class="n">debug_handler</span><span class="o">.</span><span class="n">stop_execution_timing</span><span class="p">()</span>  <span class="c1"># Mesure le temps d&#39;exécution du code étudiant</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">golden_tta</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">fichier_res</span>
    <span class="p">):</span>  <span class="c1"># stdout a été redirigé vers un fichier ; le fermer pour ne rien perdre</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span></div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2023-2024, Frédéric Mailhot et Université de Sherbrooke.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>